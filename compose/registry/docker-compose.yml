# This file can be used to start multiple containers supporting the SOLA Registry solution. Use the command
# docker-compose up -d
version: '3' 

networks:
    sola_reg: 
    
services:
    db:
        image: mcdowella/sola-registry-db
        ports:
         - "5432:5432"
        container_name: sola-db
        environment:
          POSTGRES_PASSWORD: sola
          CREATE_SOLA_DB: y
          SOLA_LOAD_DATA: y
        networks:
           sola_reg:
               aliases:
                 - database
                 
    server:
        image: mcdowella/sola-registry-server
        container_name: sola-srv
        ports:
         - "4848:4848"
         - "8080:8080"
         - "8181:8181"
        depends_on:
         - db
        environment:
          WAIT_TIME: 90 # See init_2_delay_start.sh. Time to wait in seconds before starting the Payara domain
        networks:
           sola_reg:

    # Container that deploys pgAdmin4 to allow administration of the SOLA database. Accessible on localhost:8000	   
    #dbadmin:
    #    image: dpage/pgadmin4
    #    container_name: db-admin
    #    ports:
    #     - "80:8000"
    #    environment:
    #      PGADMIN_DEFAULT_EMAIL: db@flossola.org # pgAdmin 4 username
    #      PGADMIN_DEFAULT_PASSWORD: sola         # pgAdmin 4 password
    #    networks:
    #       sola_reg: 